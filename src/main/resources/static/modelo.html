<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <title>Detalle Modelo ¬∑ Regata Online</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css"/>
</head>
<body>
<nav class="navbar navbar-expand-lg bg-light border-bottom">
  <div class="container">
    <a class="navbar-brand fw-bold" href="/dashboard.html">üèÅ Regata Online</a>
  </div>
</nav>

<div class="container my-4">
  <div class="card shadow-sm">
    <div class="card-header d-flex justify-content-between align-items-center">
      <span class="fw-semibold">Detalle del Modelo</span>
      <a class="btn btn-secondary btn-sm" href="/modelos.html">Volver</a>
    </div>
    <div class="card-body" id="detalle">
      <p class="text-muted">Cargando informaci√≥n del modelo...</p>
    </div>
  </div>
</div>

<script>
const API = "/api/modelos-barcos";

function getId() {
  const p = new URLSearchParams(location.search);
  return p.get("id");
}

async function cargarModelo() {
  const id = getId();
  if (!id) {
    document.getElementById("detalle").innerHTML = "<div class='alert alert-danger'>No se especific√≥ el ID del modelo.</div>";
    return;
  }

  try {
    const res = await fetch(`${API}/${id}`);
    if (!res.ok) throw new Error("Modelo no encontrado");
    const modelo = await res.json();

    document.getElementById("detalle").innerHTML = `
      <h4 class="mb-3">Modelo #${modelo.id}</h4>
      <ul class="list-group mb-3">
        <li class="list-group-item"><b>Nombre:</b> ${modelo.nombre}</li>
        <li class="list-group-item">
          <b>Color:</b>
          <span class="badge" style="background:${modelo.colorHex};">${modelo.colorHex}</span>
        </li>
      </ul>
      <div class="text-center my-3">
        <div style="width:120px;height:120px;border-radius:10px;margin:auto;border:2px solid #ccc;background:${modelo.colorHex};"></div>
      </div>
      <div class="text-center">
        <button class="btn btn-warning me-2" onclick="editar(${modelo.id})">Editar</button>
        <button class="btn btn-danger" onclick="eliminar(${modelo.id})">Eliminar</button>
      </div>
    `;
  } catch (err) {
    document.getElementById("detalle").innerHTML =
      `<div class='alert alert-danger'>Error al cargar el modelo: ${err.message}</div>`;
  }
}

async function editar(id) {
  const nombre = prompt("Nuevo nombre del modelo:");
  if (!nombre) return;
  const color = prompt("Nuevo color hex:", "#2ecc71");
  if (!color) return;

  await fetch(`${API}/${id}`, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ id, nombre, colorHex: color })
  });

  alert("Modelo actualizado correctamente.");
  cargarModelo();
}

async function eliminar(id) {
  if (!confirm("¬øSeguro que deseas eliminar este modelo?")) return;
  await fetch(`${API}/${id}`, { method: "DELETE" });
  alert("Modelo eliminado.");
  location.href = "/modelos.html";
}

cargarModelo();
</script>
</body>
</html>
